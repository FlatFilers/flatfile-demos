var FlatfileImporter=function(){"use strict";var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};var t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};function n(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var r=setTimeout;function o(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function a(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void c(t.promise,e)}u(t.promise,r)}else(1===e._state?u:c)(t.promise,e._value)})):e._deferreds.push(t)}function u(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void s(e);if("function"==typeof n)return void l((r=n,o=t,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=t,s(e)}catch(t){c(e,t)}var r,o}function c(e,t){e._state=2,e._value=t,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,u(t,e))},function(e){n||(n=!0,c(t,e))})}catch(e){if(n)return;n=!0,c(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return a(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},i.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})},i.all=function(e){return new i(function(t,n){if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var o=r.length;function i(e,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var u=a.then;if("function"==typeof u)return void u.call(a,function(t){i(e,t)},n)}r[e]=a,0==--o&&t(r)}catch(e){n(e)}}for(var a=0;a<r.length;a++)i(a,r[a])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)})},i._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){r(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var f=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();f.Promise||(f.Promise=i);function p(e,t){return e(t={exports:{}},t.exports),t.exports}var d=p(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1));function o(e,t,r,o,i){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new function(e,t,n){this.fn=e,this.context=t,this.once=n||!1}(r,o||e,i),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function i(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,a=new Array(i);o<i;o++)a[o]=r[o].fn;return a},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,o,i,a){var u=n?n+e:e;if(!this._events[u])return!1;var c,s,l=this._events[u],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,o),!0;case 5:return l.fn.call(l.context,t,r,o,i),!0;case 6:return l.fn.call(l.context,t,r,o,i,a),!0}for(s=1,c=new Array(f-1);s<f;s++)c[s-1]=arguments[s];l.fn.apply(l.context,c)}else{var p,d=l.length;for(s=0;s<d;s++)switch(l[s].once&&this.removeListener(e,l[s].fn,void 0,!0),f){case 1:l[s].fn.call(l[s].context);break;case 2:l[s].fn.call(l[s].context,t);break;case 3:l[s].fn.call(l[s].context,t,r);break;case 4:l[s].fn.call(l[s].context,t,r,o);break;default:if(!c)for(p=1,c=new Array(f-1);p<f;p++)c[p-1]=arguments[p];l[s].fn.apply(l[s].context,c)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,o){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return i(this,a),this;var u=this._events[a];if(u.fn)u.fn!==t||o&&!u.once||r&&u.context!==r||i(this,a);else{for(var c=0,s=[],l=u.length;c<l;c++)(u[c].fn!==t||o&&!u[c].once||r&&u[c].context!==r)&&s.push(u[c]);s.length?this._events[a]=1===s.length?s[0]:s:i(this,a)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&i(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}).EventEmitter,h=["interactive","complete"],m=function(e,t){return new Promise(function(n){e&&"function"!=typeof e&&(t=e,e=null),t=t||window.document;var r=function(){return n(void(e&&setTimeout(e)))};-1!==h.indexOf(t.readyState)?r():t.addEventListener("DOMContentLoaded",r)})};m.resume=function(e){return function(t){return m(e).then(function(){return t})}};var y=[],v=[],b="insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).";function g(e,t){if(t=t||{},void 0===e)throw new Error(b);var n=!0===t.prepend?"prepend":"append",r=void 0!==t.container?t.container:document.querySelector("head"),o=y.indexOf(r);-1===o&&(o=y.push(r)-1,v[o]={});var i;return void 0!==v[o]&&void 0!==v[o][n]?i=v[o][n]:(i=v[o][n]=function(){var e=document.createElement("style");return e.setAttribute("type","text/css"),e}(),"prepend"===n?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)),65279===e.charCodeAt(0)&&(e=e.substr(1,e.length)),i.styleSheet?i.styleSheet.cssText+=e:i.textContent+=e,i}var w=g,_=g;w.insertCss=_;var O=function(e){return new P(e)};function $(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function P(e){if(!(this instanceof P))return new P(e);e||(e={}),e.nodeType&&(e={el:e}),this.opts=e,this.el=e.el||document.body,"object"!=typeof this.el&&(this.el=document.querySelector(this.el))}P.prototype.add=function(e){var t=this.el;if(t){if(""===t.className)return t.className=e;var n=t.className.split(" ");return $(n,e)>-1?n:(n.push(e),t.className=n.join(" "),n)}},P.prototype.remove=function(e){var t=this.el;if(t&&""!==t.className){var n=t.className.split(" "),r=$(n,e);return r>-1&&n.splice(r,1),t.className=n.join(" "),n}},P.prototype.has=function(e){var t=this.el;if(t){return $(t.className.split(" "),e)>-1}},P.prototype.toggle=function(e){this.el&&(this.has(e)?this.remove(e):this.add(e))};var k,j=p(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="handshake-reply",r="rejected",o="message",i=t.ERR_CONNECTION_DESTROYED="ConnectionDestroyed",a=t.ERR_CONNECTION_TIMEOUT="ConnectionTimeout",u=t.ERR_NOT_IN_IFRAME="NotInIframe",c={"http:":"80","https:":"443"},s=/^(https?:)?\/\/([^\/:]+)(:(\d+))?/,l={ERR_CONNECTION_DESTROYED:i,ERR_CONNECTION_TIMEOUT:a,ERR_NOT_IN_IFRAME:u,Promise:function(){try{return window?window.Promise:null}catch(e){return null}}(),debug:!1},f=function(){var e=0;return function(){return++e}}(),p=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(l.debug){var r;(r=console).log.apply(r,["[Penpal]"].concat(t))}},d=function(e){var t=[];return e(function(){t.forEach(function(e){e()})}),{then:function(e){t.push(e)}}},h=function(e){return{name:e.name,message:e.message,stack:e.stack}},m=function(e,t,n,r){var a=t.localName,u=t.local,c=t.remote,s=t.remoteOrigin,d=!1;p(a+": Connecting call sender");var h=function(e){return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];if(p(a+": Sending "+e+"() call"),d){var h=new Error("Unable to send "+e+"() call due to destroyed connection");throw h.code=i,h}return new l.Promise(function(t,r){var i=f();u.addEventListener(o,function n(l){if(l.source===c&&l.origin===s&&"reply"===l.data.penpal&&l.data.id===i){p(a+": Received "+e+"() reply"),u.removeEventListener(o,n);var f=l.data.returnValue;l.data.returnValueIsError&&(f=function(e){var t=new Error;return Object.keys(e).forEach(function(n){return t[n]=e[n]}),t}(f)),("fulfilled"===l.data.resolution?t:r)(f)}}),c.postMessage({penpal:"call",id:i,methodName:e,args:n},s)})}};r.then(function(){d=!0}),n.reduce(function(e,t){return e[t]=h(t),e},e)},y=function(e,t,n){var i=e.localName,a=e.local,u=e.remote,c=e.remoteOrigin,s=!1;p(i+": Connecting call receiver");var f=function(e){if(e.source===u&&e.origin===c&&"call"===e.data.penpal){var n=e.data,o=n.methodName,a=n.args,f=n.id;if(p(i+": Received "+o+"() call"),o in t){var d=function(e){return function(t){if(p(i+": Sending "+o+"() reply"),s)p(i+": Unable to send "+o+"() reply due to destroyed connection");else{var n={penpal:"reply",id:f,resolution:e,returnValue:t};e===r&&t instanceof Error&&(n.returnValue=h(t),n.returnValueIsError=!0);try{u.postMessage(n,c)}catch(e){throw"DataCloneError"===e.name&&u.postMessage({penpal:"reply",id:f,resolution:r,returnValue:h(e),returnValueIsError:!0},c),e}}}};new l.Promise(function(e){return e(t[o].apply(t,a))}).then(d("fulfilled"),d(r))}}};a.addEventListener(o,f),n.then(function(){s=!0,a.removeEventListener(o,f)})};l.connectToChild=function(e){var t=e.url,r=e.appendTo,u=e.methods,f=void 0===u?{}:u,h=e.timeout,v=void 0,b=new d(function(e){return v=e}),g=window,w=document.createElement("iframe");(r||document.body).appendChild(w),b.then(function(){w.parentNode&&w.parentNode.removeChild(w)});var _=w.contentWindow||w.contentDocument.parentWindow,O=function(e){var t=document.location,n=s.exec(e),r=void 0,o=void 0,i=void 0;return n?(r=n[1]?n[1]:t.protocol,o=n[2],i=n[4]):(r=t.protocol,o=t.hostname,i=t.port),r+"//"+o+(i&&i!==c[r]?":"+i:"")}(t);return{promise:new l.Promise(function(e,r){var u;void 0!==h&&(u=setTimeout(function(){var e=new Error("Connection to child timed out after "+h+"ms");e.code=a,r(e),v()},h));var c={},s=void 0,l=function(t){if(t.source===_&&t.origin===O&&"handshake"===t.data.penpal){p("Parent: Received handshake, sending reply"),t.source.postMessage({penpal:n,methodNames:Object.keys(f)},t.origin);var r={localName:"Parent",local:g,remote:_,remoteOrigin:t.origin};y(r,f,b),s&&s.forEach(function(e){delete c[e]}),s=t.data.methodNames,m(c,r,s,b),clearTimeout(u),e(c)}};g.addEventListener(o,l),b.then(function(){g.removeEventListener(o,l);var e=new Error("Connection destroyed");e.code=i,r(e)}),p("Parent: Loading iframe"),w.src=t}),iframe:w,destroy:v}},l.connectToParent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.parentOrigin,r=void 0===t?"*":t,c=e.methods,s=void 0===c?{}:c,f=e.timeout;if(window===window.top){var h=new Error("connectToParent() must be called within an iframe");throw h.code=u,h}var v=void 0,b=new d(function(e){return v=e}),g=window,w=g.parent;return{promise:new l.Promise(function(e,t){var u;void 0!==f&&(u=setTimeout(function(){var e=new Error("Connection to parent timed out after "+f+"ms");e.code=a,t(e),v()},f));var c=function t(i){if(("*"===r||r===i.origin)&&i.source===w&&i.data.penpal===n){p("Child: Received handshake reply"),g.removeEventListener(o,t);var a={localName:"Child",local:g,remote:w,remoteOrigin:i.origin},c={};y(a,s,b),m(c,a,i.data.methodNames,b),clearTimeout(u),e(c)}};g.addEventListener(o,c),b.then(function(){g.removeEventListener(o,c);var e=new Error("Connection destroyed");e.code=i,t(e)}),p("Child: Sending handshake"),w.postMessage({penpal:"handshake",methodNames:Object.keys(s)},r)}),destroy:v}},t.default=l}),C=(k=j,k&&k.__esModule?k.default:k),E=function(){function e(e){this.$meta=e}return Object.defineProperty(e.prototype,"originalRows",{get:function(){return this.$meta.count_rows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"acceptedRows",{get:function(){return this.$meta.count_rows_accepted||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originalColumns",{get:function(){return this.$meta.count_columns||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matchedColumns",{get:function(){return this.$meta.count_columns_matched||null},enumerable:!0,configurable:!0}),e}(),N=function(){function e(e){this.$user=e}return Object.defineProperty(e.prototype,"id",{get:function(){return this.$user.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userId",{get:function(){return this.$user.userId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.$user.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"email",{get:function(){return this.$user.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"companyName",{get:function(){return this.$user.companyName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"companyId",{get:function(){return this.$user.companyId},enumerable:!0,configurable:!0}),e}(),x=function(){function e(e){this.$file=e}return Object.defineProperty(e.prototype,"id",{get:function(){return this.$file.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filename",{get:function(){return this.$file.filename},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filesize",{get:function(){return this.$file.filesize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filetype",{get:function(){return this.$file.filetype},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this.$file.url},enumerable:!0,configurable:!0}),e}(),T=function(){function e(e,t){this.$meta=t,this.$data=e}return Object.defineProperty(e.prototype,"rawOutput",{get:function(){return this.$data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.validData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"validData",{get:function(){return this.$data.filter(function(e){return e.valid}).filter(function(e){return!e.deleted}).map(function(e){return e.data})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deletedData",{get:function(){return this.$data.filter(function(e){return e.deleted}).map(function(e){return e.data})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allData",{get:function(){return this.$data.map(function(e){return e.data})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"remainingChunks",{get:function(){return Math.ceil((this.totalChunks-this.currentChunk)/this.$meta.inChunks)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalChunks",{get:function(){return Math.ceil(this.$meta.count_rows_accepted/this.$meta.inChunks)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chunkSize",{get:function(){return this.$meta.inChunks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentChunk",{get:function(){return(this.$meta.pointer+this.chunkSize)/this.chunkSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasMore",{get:function(){return this.$meta.hasMore},enumerable:!0,configurable:!0}),e}(),R=function(){function e(e,t,n){this.$meta=t,this.$data=e,this.$importer=n}return Object.defineProperty(e.prototype,"rawOutput",{get:function(){return this.blobOnly(this.$data,"rawOutput")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.blobOnly(this.validData,"data")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"validData",{get:function(){var e=this.$data.filter(function(e){return e.valid}).filter(function(e){return!e.deleted}).map(function(e){return e.data});return this.blobOnly(e,"validData")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deletedData",{get:function(){var e=this.$data.filter(function(e){return e.deleted}).map(function(e){return e.data});return this.blobOnly(e,"deletedData")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allData",{get:function(){return this.blobOnly(this.$data.map(function(e){return e.data}),"allData")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchId",{get:function(){return this.$meta.batchID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stats",{get:function(){return new E(this.$meta)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"customer",{get:function(){return this.$meta.endUser?new N(this.$meta.endUser):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originalFile",{get:function(){return this.$meta.originalFile?new x(this.$meta.originalFile):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"csvFile",{get:function(){if(this.$meta.originalFile){if("csv"===this.$meta.originalFile.filetype)return new x(this.$meta.originalFile);if(this.$meta.csvFile)return new x(this.$meta.csvFile)}return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fileName",{get:function(){return this.$meta.filename||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"managed",{get:function(){return this.$meta.managed||!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"manual",{get:function(){return this.$meta.manual},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this.$meta.config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parsingConfig",{get:function(){return this.$meta.parsing_config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skippedRows",{get:function(){return this.$meta.skipped_rows||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headersRaw",{get:function(){return this.$meta.headers_raw||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headersMatched",{get:function(){return this.$meta.headers_matched||null},enumerable:!0,configurable:!0}),e.prototype.nextChunk=function(){var e=this;return new Promise(function(t,n){if(!e.$meta.inChunks)return n('"nextChunk()" is only accessible when using "inChunks". Please see docs for "requestDataFromUser".');e.$importer.$ready.then(function(e){console.log("child.nextChunk()"),e.nextChunk().then(function(e){console.log("nextChunk()",e),t(e.results.length?new T(e.results,e.meta):null)},function(e){console.log("nextChunk(err)",e)})})})},Object.defineProperty(e.prototype,"customColumns",{get:function(){return this.$meta.custom_columns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failureReason",{get:function(){return this.$meta.failure_reason||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"submittedAt",{get:function(){return this.$meta.submitted_at||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failedAt",{get:function(){return this.$meta.failed_at||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"createdAt",{get:function(){return this.$meta.created_at},enumerable:!0,configurable:!0}),e.prototype.blobOnly=function(e,t,n){if(void 0===n&&(n="nextChunk()"),this.$meta.inChunks)throw new Error('"'+t+'" is not accessible when using "inChunks". Please see docs for "'+n+'" instead.');return e},e}();return function(r){!function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(o,r);function o(e,t,n){var i=r.call(this)||this;return i.$fieldHooks=[],i.apiKey=e,i.options=t,i.customer=n,i.uuid=i.$generateUuid(),i.$ready=new o.Promise(function(e,t){i.$resolver=e,i.$rejecter=t}),m(function(){i.initialize()}),i}return o.setMountUrl=function(e){this.MOUNT_URL=e},o.setVersion=function(e){switch(e){case 1:this.MOUNT_URL="https://kiosk-lite.flatfile.io/?key=:key";break;case 2:this.MOUNT_URL="https://portal-2.flatfile.io/?key=:key";break;default:throw new Error(e+" is not a valid version")}},o.prototype.open=function(e){var n=this;void 0===e&&(e={}),e=t({},e,{hasRecordHook:!!this.$recordHook,fieldHooks:this.$fieldHooks.map(function(e){return e.field}),endUser:this.customer}),this.$ready.then(function(t){O(document.body).add("flatfile-active");var r=document.getElementById("flatfile-"+n.uuid);r&&(r.style.display="block"),t.open(e)})},o.prototype.load=function(){var e=this;return new o.Promise(function(t,n){e.open();var r=function(){e.removeListener("close",i),e.removeListener("complete",o)};function o(e){t(e),r()}function i(e){n(e),r()}e.on("close",i),e.on("complete",o)})},o.prototype.requestDataFromUser=function(e){return void 0===e&&(e={}),this.open(t({},e,{inChunks:e.inChunks||null,expectsExpandedResults:!0})),this.responsePromise()},o.prototype.displayLoader=function(e){this.$ready.then(function(t){t.displayLoader(e)})},o.prototype.displayError=function(e){this.$ready.then(function(t){t.displayError(e)})},o.prototype.requestCorrectionsFromUser=function(e){return this.$ready.then(function(t){t.displayError(e)}),this.responsePromise()},o.prototype.displaySuccess=function(e){this.$ready.then(function(t){t.displaySuccess(e)})},o.prototype.getMeta=function(){var e=this;return new Promise(function(t,n){e.$ready.then(function(e){e.getMeta().then(t).catch(n)}).catch(n)})},o.prototype.setCustomer=function(e){this.customer=e},o.prototype.registerValidatorCallback=function(e){this.$validatorCallback=e,this.$ready.then(function(e){e.parentHasValidator()})},o.prototype.registerRecordHook=function(e){this.$recordHook=e},o.prototype.registerFieldHook=function(e,t){this.$fieldHooks.push({field:e,cb:t})},o.prototype.close=function(){this.$ready.then(function(e){e.close()})},o.prototype.handleClose=function(){O(document.body).remove("flatfile-active");var e=document.getElementById("flatfile-"+this.uuid);e&&(e.style.display="none")},o.prototype.initialize=function(){var e=this;w("\n      .flatfile-component {\n        position: fixed;\n        top: 0;\n        bottom: 0;\n        right: 0;\n        left: 0;\n        display: none;\n        z-index: 100000;\n      }\n      .flatfile-component iframe {\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        border-width: 0;\n      }\n      body.flatfile-active {\n        overflow: hidden;\n        overscroll-behavior-x: none;\n      }\n    "),document.body.insertAdjacentHTML("beforeend",'<div id="flatfile-'+this.uuid+'" class="flatfile-component"></div>'),this.handshake=C.connectToChild({appendTo:document.getElementById("flatfile-"+this.uuid)||void 0,url:o.MOUNT_URL.replace(":key",this.apiKey),methods:{results:function(t){e.emit("results",t.results,t.meta)},complete:function(t){e.emit("complete",t.rows,t.meta)},close:function(){e.emit("close"),e.handleClose()},validatorCallback:function(t){return e.$validatorCallback?e.$validatorCallback(t):void 0},dataHookCallback:function(t,n){return e.$recordHook?e.$recordHook(t,n):void 0},fieldHookCallback:function(t,n){var r=e.$fieldHooks.find(function(e){return e.field===n.field});if(r)return r.cb(t,n)},ready:function(){return e.handshake.promise.then(function(t){e.$resolver(t),e.customer&&t.setUser(e.customer)}).catch(function(e){console.error(e)}),e.options}}}),this.handshake.promise.catch(function(t){e.$rejecter(t)})},o.prototype.$generateUuid=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},o.prototype.responsePromise=function(){var e=this;return new Promise(function(t,r){var o=function(r,o){return i=e,a=void 0,s=function(){var e;return n(this,function(n){return e=new R(r,o,this),t(e),u(),[2]})},new((c=void 0)||(c=Promise))(function(e,t){function n(e){try{o(s.next(e))}catch(e){t(e)}}function r(e){try{o(s.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new c(function(e){e(t.value)}).then(n,r)}o((s=s.apply(i,a||[])).next())});var i,a,c,s};function i(e){r(e),u()}var a=e;function u(){a.removeListener("close",i),a.removeListener("results",o)}e.on("close",i),e.on("results",o)})},o.Promise=Promise,o.MOUNT_URL="https://kiosk-lite.flatfile.io/?key=:key",o}(d)}();